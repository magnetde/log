image: golang:1.16

stages:
  - build
  - test

compile:
  stage: build
  script:
    - go build

test:
  stage: test
  before_script:
    - go get github.com/boumenot/gocover-cobertura
  script:
    - go test -cover -coverprofile=coverage.txt -covermode count
    - gocover-cobertura < coverage.txt > cobertura-coverage.xml
  artifacts:
    reports:
      cobertura: cobertura-coverage.xml
